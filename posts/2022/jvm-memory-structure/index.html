

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="https://uposs.justokay.cn/images/favicon.ico">
  <link rel="icon" href="https://uposs.justokay.cn/images/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="dyhu">
  <meta name="keywords" content="">
  
    <meta name="description" content="OverviewJava Virtual Machine (JVM) is an abstract computer, based on a stack architecture, with its own instruction set and memory management. It loads class files, parses, interprets and executes byt">
<meta property="og:type" content="article">
<meta property="og:title" content="Memory Structure In Java">
<meta property="og:url" content="https://okayhu.github.io/blog/posts/2022/jvm-memory-structure/index.html">
<meta property="og:site_name" content="dyhu&#39;s blog">
<meta property="og:description" content="OverviewJava Virtual Machine (JVM) is an abstract computer, based on a stack architecture, with its own instruction set and memory management. It loads class files, parses, interprets and executes byt">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://uposs.justokay.cn/images/jvm/jvm.png">
<meta property="article:published_time" content="2022-06-22T13:47:45.000Z">
<meta property="article:modified_time" content="2023-01-08T04:00:57.049Z">
<meta property="article:author" content="dyhu">
<meta property="article:tag" content="jvm">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://uposs.justokay.cn/images/jvm/jvm.png">
  
  
  
  <title>Memory Structure In Java - dyhu&#39;s blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/blog/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/blog/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/blog/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/blog/css/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"okayhu.github.io","root":"/blog/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"https://uposs.justokay.cn/images/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":"G-NZR9Y6CNBN","gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/blog/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/blog/js/utils.js" ></script>
  <script  src="/blog/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/blog/atom.xml" title="dyhu's blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/blog/">
      <strong>dyhu&#39;s blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/blog/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" false
     style="background: url('https://uposs.justokay.cn/images/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Memory Structure In Java"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-06-22 21:47" pubdate>
          2022-06-22
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.3k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          61 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Memory Structure In Java</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Java Virtual Machine (JVM) is an abstract computer, based on a stack architecture, with its own instruction set and memory management. It loads class files, parses, interprets and executes bytecode. The basic structure is as follows.</p>
<p><img src="https://uposs.justokay.cn/images/jvm/jvm-memory-structure-01.png" srcset="https://uposs.justokay.cn/images/loading.gif" lazyload></p>
<p>Java virtual machine divides the memory it manages into regions during the execution of a Java program. As shown in the figure.</p>
<p><img src="https://uposs.justokay.cn/images/jvm/jvm-memory-structure-02.png" srcset="https://uposs.justokay.cn/images/loading.gif" lazyload></p>
<p>The JVM memory structure is divided into three main blocks: heap, stack, and method areas. The heap is the largest area in the JVM and consists of the young and old generations, <strong>which in turn are divided into two parts, the Eden and Survivor areas, which in turn are divided into the From and To areas</strong>, and by default the young generations are allocated in a ratio of <strong>8:1:1</strong>.</p>
<p>A diagram shows how the memory size of each region can be controlled by the following parameters.</p>
<p><img src="https://uposs.justokay.cn/images/jvm/jvm-memory-structure-03.png" srcset="https://uposs.justokay.cn/images/loading.gif" lazyload></p>
<ul>
<li><code>Xms</code>: sets the minimum space size of the heap.</li>
<li><code>Xmx</code>: sets the maximum space size of the heap.</li>
<li><code>XX:NewSize</code>: set the minimum space size of the new generation.</li>
<li><code>XX:MaxNewSize</code>: set the maximum space size of the new generation.</li>
<li><code>XX:PermSize</code>: set the minimum space size of the permanent generation.</li>
<li><code>XX:MaxPermSize</code>: set the maximum space size of the permanent generation.</li>
<li><code>Xss</code>: set the stack size of each thread.</li>
</ul>
<div class="note note-info">
            <p>There is no parameter to set the old age directly, but you can set both heap space size and new generation space size to control it indirectly. (old generation space size &#x3D; heap space size - young generation space size)</p>
          </div>

<h2 id="Heap"><a href="#Heap" class="headerlink" title="Heap"></a>Heap</h2><p>For most applications, the Heap is the largest piece of memory managed by the Java Virtual Machine. The heap is an area of memory that is shared by all threads and is created at virtual machine startup. The sole purpose of this memory area is to hold object instances, and almost all object instances are allocated memory here.</p>
<p>The heap is the main area managed by GC. If we look at it from the memory recovery point of view, since GC basically uses a generational collection algorithm, the heap can also be subdivided into: new generations and old generations. When let subdivided further, there are also the Eden area, From Survivor area, and To Survivor area.</p>
<p>According to the Java Virtual Machine specification, the heap can be in a physically discontinuous memory space, as long as it is logically contiguous, just like our disk space. When implemented, it can either be implemented as fixed size or scalable, although the current mainstream VMs are implemented as scalable (controlled by <code>-Xmx</code> and <code>-Xms</code>).</p>
<p>An OutOfMemoryError exception is thrown if there is no memory left in the heap for instance allocation and the heap can no longer be extended.</p>
<h2 id="Method-Area"><a href="#Method-Area" class="headerlink" title="Method Area"></a>Method Area</h2><p>Method area, like the heap, is an area of memory shared by all threads. It is used to store data such as class information, constants, static variables, and code compiled by the immediate compiler that has been loaded by the virtual machine.</p>
<p>For developers used to developing and deploying programs on the HotSpot virtual machine, many would like to refer to the method area as the Permanent Generation, but essentially the two are not equivalent. It is simply because the HotSpot VM design team chose to extend GC generation collection to the method zone, or use the Permanent Generation to implement the method zone.</p>
<p>The Java Virtual Machine specification is very restrictive on this region, and in addition to not requiring contiguous memory like the heap and having the option to be fixed-sized or scalable, it also has the option to not implement garbage collection. The goal of memory reclamation in this area is mainly for constant pool reclamation and offloading of types. In general, it is difficult to achieve satisfactory results in this area, especially for offloading of types, which is quite demanding, but reclamation of this part of the area is really necessary.</p>
<div class="note note-info">
            <p>Garbage collection is relatively rare in this region, but it is not as permanent as the name of the permanent generation once the data enters the method region.</p>
          </div>

<p>According to the Java Virtual Machine specification, an OutOfMemoryError exception is thrown when the method area cannot meet the memory allocation requirements.</p>
<h2 id="The-pc-Register"><a href="#The-pc-Register" class="headerlink" title="The pc Register"></a>The pc Register</h2><p>The pc Register is thread private and can be seen as a line number indicator for the bytecode executed by the current thread.</p>
<p>When the bytecode interpreter is working, it picks and records the next bytecode instruction to be executed by changing the value of the program counter. It is an indicator of the program control flow and is relied upon for branching, looping, skipping, exception handling, thread recovery, etc.</p>
<ul>
<li>If a thread is executing a Java method, the program counter records the address of the VM bytecode instruction being executed.</li>
<li>If a Native method is being executed, the counter value is <code>Undefined</code>.</li>
</ul>
<div class="note note-info">
            <p>The pc Register is the only area of the Java Virtual Machine specification that does not specify any OutOfMemoryError cases.</p>
          </div>

<h2 id="Java-Virtual-Machine-Stacks"><a href="#Java-Virtual-Machine-Stacks" class="headerlink" title="Java Virtual Machine Stacks"></a>Java Virtual Machine Stacks</h2><p>Each thread has a private java virtual machine stacks<br>that is created and destroyed at the same time as the thread. It holds local variables and partial results, and acts on method calls and returns.<br>The memory of java virtual machine stacks need not be contiguous.</p>
<p>java virtual machine stacks<br>describes the threaded memory model for Java method execution: each method creates a stack frame (<code>Frames</code>) while executing, which stores information such as local variable tables, operand stacks, dynamic links, method exports, etc. The process of each method from invocation to execution completion corresponds to the process of entering and leaving a stack frame on the Java virtual machine stack.</p>
<ul>
<li>Each method corresponds to one stack frame</li>
<li>The data structure of the stack is <code>FILO</code></li>
</ul>
<div class="code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;
    <span class="hljs-type">Work</span> <span class="hljs-variable">work</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Work</span>();
    work.a();
&#125;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">a</span><span class="hljs-params">()</span> &#123;
    b();
&#125;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">b</span><span class="hljs-params">()</span> &#123;
    <span class="hljs-comment">// do something</span>
&#125;</code></pre></div>

<p>Next, let’s analyze the structure of the virtual machine stack frame in detail</p>
<h3 id="Local-Variables-Table"><a href="#Local-Variables-Table" class="headerlink" title="Local Variables Table"></a>Local Variables Table</h3><p>As the name implies, the local variables table is used to store method parameters and local variables defined within the method. <strong>There are 8 basic data types, the reference type (which is not the same as the object itself, but may be a reference pointer to the object’s start address, a handle to the object or some other location related to the object) and the returnAddress type (which points to the address of a bytecode instruction)</strong>.</p>
<p>The capacity of the local variables table is the smallest unit of the <code>Variable Slot</code>, with a 32 bit value occupying one Solt and a 64 bit value occupying two consecutive Solts.</p>
<p>When a method is called, the java virtual machine uses the local variables table to complete the transfer of parameter values to the list of parameter variables, i.e., from real to formal parameters. If an instance method (non-static) is executed, then the variable slot indexed at position 0 in the local variables table is used by default to pass a reference to the instance of the object to which the method belongs (this)</p>
<p>The maximum capacity (number of Slots) of the local variables table to be allocated for the method is determined in the <code>max_locals</code> data item in the Code property of the method when the Java program is compiled into a Class file.</p>
<h3 id="Operand-Stacks"><a href="#Operand-Stacks" class="headerlink" title="Operand Stacks"></a>Operand Stacks</h3><p>The operand stack is a <code>LIFO</code>. When a method first starts execution, its operand stack is empty. As the method executes and bytecode instructions are executed, constants or variables are copied from the local variable table or fields of the object instance and written to the operand stack, and then the elements of the stack are stacked out to the local variable table or returned to the method caller as the computation proceeds, i.e., the stack-out&#x2F;stack-in operation. A complete method execution often contains multiple such stack-out&#x2F;stack-in processes.</p>
<p>Each operand stack has an explicit stack depth for storing values, a 32 bit value can be stored in one unit of stack depth, while a 64 bit value requires 2 units of stack depth.</p>
<p>The maximum depth of the operand stack is written to the <code>max_stacks</code> data item of the method’s Code property at compile time.</p>
<h3 id="Dynamic-Linking"><a href="#Dynamic-Linking" class="headerlink" title="Dynamic Linking"></a>Dynamic Linking</h3><p>Each stack frame contains a reference to the method in the runtime constants pool to which the stack frame belongs. This reference is held to support inter-method invocations.</p>
<h3 id="Method-Invocation-Completion"><a href="#Method-Invocation-Completion" class="headerlink" title="Method Invocation Completion"></a>Method Invocation Completion</h3><p>When a method begins execution, there are only two ways to exit the method.</p>
<ul>
<li>When the execution engine encounters a bytecode instruction returned by any of the methods, it exits the method, which is called: <code>Normal Method Invocation Completion</code>.</li>
<li>If an exception occurs during the execution of a method and is not handled in the method body, it causes the method to exit. This type of exit is called: <code>Abrupt Method Invocation Completion</code>.</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/blog/categories/Java/" class="category-chain-item">Java</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/blog/tags/jvm/">#jvm</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Memory Structure In Java</div>
      <div>https://okayhu.github.io/blog/posts/2022/jvm-memory-structure/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>dyhu</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>June 22, 2022</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/blog/posts/2022/linux-ssh-port-update/" title="Modify The Linux Server SSH Port">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Modify The Linux Server SSH Port</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/blog/posts/2022/nginx-docker-install/" title="Installing Nginx with Docker">
                        <span class="hidden-mobile">Installing Nginx with Docker</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    
      <script type="text/javascript">
        var disqus_config = function() {
          this.page.url = 'https://okayhu.github.io/blog/posts/2022/jvm-memory-structure/';
          this.page.identifier = '/blog/posts/2022/jvm-memory-structure/';
        };
        Fluid.utils.loadComments('#disqus_thread', function() {
          var d = document, s = d.createElement('script');
          s.src = '//' + 'dyhu-blog' + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', new Date());
          (d.head || d.body).appendChild(s);
        });
      </script>
    
    <noscript>Please enable JavaScript to view the comments</noscript>
  </div>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Table of Contents</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
      Copyright © 2022 dyhu - <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a><i class="iconfont icon-love"></i><a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/blog/js/events.js" ></script>
<script  src="/blog/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/blog/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/blog/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/blog/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
